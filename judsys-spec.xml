<?xml version="1.0" encoding="utf-8"?>
<!-- name="GENERATOR" content="github.com/mmarkdown/mmark markdown processor for Go" -->
<!DOCTYPE rfc SYSTEM 'rfc2629.dtd' []>
<rfc ipr="trust200902" submissionType="independent" category="exp" xml:lang="en" consensus="no" docName="draft-judsys1-00">
<?rfc toc="yes"?><?rfc symrefs="yes"?><?rfc sortrefs="yes"?><?rfc compact="yes"?><?rfc subcompact="no"?><?rfc comments="no"?>
<front>
<title abbrev="JUDSYS1">JSON Unified Digital Signatures System Standard 1</title><author initials="G." surname="Queiroz" fullname="Gabriel Villela Noriega de Queiroz"><organization></organization><address><postal><street></street>
<city></city>
<code></code>
<country>Brazil</country>
<region></region>
</postal><phone></phone>
<email>gabrieljvnq@gmail.com</email>
<uri></uri>
</address></author>
<date year="2018" month="9" day="6"></date>
<area>Internet</area><workgroup>No Formal Workgroup</workgroup><keyword>cryptography</keyword>
<keyword>digital signature</keyword>
<keyword>protocol</keyword>

<abstract>
<t>A simple digital signature standard designed to be used by regular people and to be of mandatory acceptance.</t>
</abstract>

</front>

<middle>

<section anchor="introduction" title="Introduction">
<t>Currently, ITI, the government body responsible of ICP-Brasil, Brazil's PKI (Public Key Infrastructure), endorses three different standards: CAdES, XAdES and PAdES.</t>
<t>Since they are all based on X.509 which is used in SSL, there should be an abundance of good software libraries and end user applications to support at least one of these standard.</t>
<t>This is not the case. While there have been some efforts to write open source libraries and end user applications for ICP-Brasil, they are hard to find and most seem unfinished and abandoned.</t>
<t>ITI provides a digital signature verification web tool, but it is only for CAdES and doesn't seem to work well.</t>
<t>PAdES is a monster of its own kind. In an attempt to replicate the paper experience in the digital world, a PDF file can be signed, edited and resigned by another person in a way that they signed over different version of the same document. This is both hard to implement and hard to explain to end users.</t>
<t>To make matters worse, PDF readers almost never come with the necessary CAs to verify ICP-Brasil digital signatures.</t>
<t>Perhaps as result of this mess of different standards, the ITI admits that, no one is obliged to accept digital signatures in Brazil (see <xref target="ITI-FAQ-21"></xref>).</t>
<t>This situation is unacceptable. We need a digital signature standard that:</t>
<t>
<list style="numbers">
<t>Is easy for programmers to implement. Including reference libraries in multiple languages.</t>
<t>Is easy for ordinary people to use on a day to day basis.</t>
<t>Has strict rules to avoid interoperability problems.</t>
<t>Has mandatory acceptance by law.</t>
</list>
</t>
<t>This document aims to provide a digital signature standard that address points one through three. Hopefully, this standard may fulfil the fourth point in the near future.</t>

<section anchor="right-of-implementation" title="Right of Implementation">
<t>Any person, group or organization can freely implement this standard so long as the implementation is complete.</t>
</section>

<section anchor="terminology" title="Terminology">
<t>The keywords MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT, SHOULD,
SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they appear in this
document, are to be interpreted as described in <xref target="RFC2119"></xref>.</t>
<t>All apps MUST use the standard translations present in this document when they present in the Language specific rules section.</t>
<t><spanx style="strong">User</spanx>: A human being using a JUDSYS app. Unless otherwise specified, users MUST always be considered as non-tech-savvy people.</t>
<t><spanx style="strong">Signing app</spanx>: A computer program that digitally signs documents according to this standard.</t>
<t><spanx style="strong">Verifier app</spanx>: A computer program that verifies a digital signature according to this standard.</t>
<t>(<spanx style="strong">App</spanx>) <spanx style="strong">JUDSYS app</spanx> or <spanx style="strong">implementation</spanx>: A computer program that is either a singing app or a verifier app or both.</t>
<t><spanx style="strong">Subject attributes</spanx>: Certain values that qualify the subject. Ex: email, full name, government issued identification numbers, et cetera.</t>
<t><spanx style="strong">Natural person</spanx>: A human begin.</t>
<t><spanx style="strong">Legal person</spanx>: A group of people who the Law considers to be its own person.</t>
<t><spanx style="strong">Software person</spanx>: A piece of software that acts in the name of a natural or legal person.</t>
<t><spanx style="strong">Digital signature</spanx>:</t>
<t>(<spanx style="strong">PKI</spanx>) <spanx style="strong">Public Key Infrastructure</spanx>:</t>
<t>(<spanx style="strong">KP</spanx>) <spanx style="strong">Key Pair</spanx>:</t>
<t><spanx style="strong">Certificate</spanx>: A short signed message that states a key pair is in the control of a specific subject.</t>
<t>(<spanx style="strong">CA</spanx>) <spanx style="strong">Certificate Authority</spanx>: A certificate that is allowed to sign other certificates. This is, a CA is an entity (usually a company or government body) that ensures that the subject on a certificate is really the person it names.</t>
<t>(<spanx style="strong">PA</spanx>) <spanx style="strong">Proof of attribute</spanx>: A short signed message in which the issuer certifies that a certain attribute is true. Examples: job titles and permissions delegated by the issuer to the subject.</t>
<t>(<spanx style="strong">TA</spanx>) <spanx style="strong">Time-stamping Authority</spanx></t>
<t>This is very similar to the concept of attribute certificates. The names was changed to avoid using the &quot;certificate&quot; in two different contexts that may confuse users.</t>
<t><spanx style="strong">ICAO</spanx>: International Civil Aviation Organization.</t>
<t><spanx style="strong">JSON</spanx>: JavaScript Object Notation.</t>
</section>
</section>

<section anchor="encoding" title="Encoding">

<section anchor="files" title="Files">
<t>All JUDSYS-1 files are JSON encoded with UTF-8.</t>
<t>To avoid canonicalization problems, all signed messages are encoded in base64.</t>
<t>Example:</t>

<figure><artwork type="js">{&quot;b&quot;: 1, &quot;a&quot;:2}
// becomes
{
    &quot;raw&quot;: &quot;eyJiIjogMSwgImEiOjJ9Cg==&quot;,
    // This is to aid humans debugging, not for machines to use 
    &quot;what&quot;: &quot;JUDSYS-1 base64&quot;
}
</artwork></figure>

<section anchor="file-extensions" title="File extensions">
<t>All JUDSYS-1 extensions begin with <spanx style="verb">.j1</spanx> (dot, jay, one).</t>
<t>For JUDSYS-1 files, all apps MUST use only the file extensions show below:</t>
<texttable>
<ttcol>Extension</ttcol>
<ttcol>Usage</ttcol>


<c><spanx style="verb">.j1c</spanx></c>
<c>Certificates (no private keys)</c>

<c><spanx style="verb">.j1a</spanx></c>
<c>Attribute certificates</c>

<c><spanx style="verb">.j1k</spanx></c>
<c>Certificates with the private keys</c>

<c><spanx style="verb">.j1s</spanx></c>
<c>Detached digital signature</c>

<c><spanx style="verb">.j1e</spanx></c>
<c>Encrypted file</c>

<c><spanx style="verb">.j1r</spanx></c>
<c>Revocation information</c>

</texttable></section>
</section>

<section anchor="strings" title="Strings">
<t>All apps MUST have proper Unicode support and fonts to display any characters that may be necessary for the country of intended use. This is, an app for France MUST have fonts with accented characters, but MAY have no CJK nor Cyrillic support. An app for Russia MUST have Cyrillic and Latin support, but MAY have no CJK or Mongolian support.</t>
<t>It is RECOMMENDED to store string in NFC (Normal Form Composition).</t>
<t>It is RECOMMENDED that all apps support as much Unicode characters and scripts as possible. It is also RECOMMENDED that all apps include the necessary fonts.</t>
<t>Emoji usage is discouraged.</t>
</section>

<section anchor="dates" title="Dates">
<t>All dates MUST be encoded as strings according to the <xref target="RFC3339"></xref>.</t>
<t>If the time is not available, it MUST be assumed to be midnight.</t>
<t>Times MUST NOT include fractions of a second.</t>
</section>

<section anchor="country-codes" title="Country codes">
<t>All countries or similar MUST be represented by the upper case three letter codes defined on ISO 3166-1 alpha-3. If a country or similar does not have such code, it MUST be full English name with spaces and proper capitalization. Ex: <spanx style="verb">Principality of Sealand</spanx> not <spanx style="verb">principality of sealand</spanx> nor <spanx style="verb">PrincipalityOf_Sealand</spanx>.</t>
<t>International organizations MUST use their upper case English acronym and their full English name separated by a hyphen with spaces on both sides. Ex: <spanx style="verb">ICAO - International Civil Aviation Organization</spanx> and <spanx style="verb">ICJ - International Court of Justice</spanx>.</t>
<t>Special cases are:</t>
<t>
<list style="numbers">
<t><spanx style="verb">UN</spanx> for the United Nations (already on the ISO 3166-1 alpha-2).</t>
<t><spanx style="verb">EU</spanx> for the European Union (already on the ISO 3166-1 alpha-2).</t>
<t><spanx style="verb">INT</spanx> for international things such as passports, names and date of birth.</t>
<t><spanx style="verb">MERCOSU</spanx> for the Southern Common Market, Mercosur in Spanish and Mercosul in Portuguese.</t>
<t><spanx style="verb">UNASU</spanx> for the Union of South American Nations, UNSAUR in Spanish and UNASUL in Portuguese.</t>
<t><spanx style="verb">NAFTA</spanx> for the North American Free Trade Agreement.</t>
<t><spanx style="verb">HOAX</spanx> for URSAL - União das Repúblicas Socialistas da America Latina. (just a joke, non-normative)</t>
</list>
</t>
</section>

<section anchor="certificate-chains" title="Certificate chains">
<t>All JUDSYS-1 files MUST include all the necessary certificates, attribute certificates and revocation files for verifying the file in question.</t>
<t>An exception is made to the root CAs which MUST NOT be included in any JUDSYS-1 file, as they MUST be a part of the apps themselves, preferably in the implementation source code.</t>
</section>
</section>

<section anchor="certificates" title="Certificates">
<t>✏️</t>

<section anchor="keys" title="Keys">
<t>All keys are encoded as a dictionaries, which MUST have the following keys:</t>
<t>
<list style="numbers">
<t><spanx style="verb">algorithm</spanx></t>
<t><spanx style="verb">id</spanx>: A hash of the key that uniquely identifies it.</t>
<t><spanx style="verb">usage</spanx>: An enum that indicates what the key may be used for. Possible values:
<list style="numbers">
<t><spanx style="verb">signing</spanx>: The key is used only to sign digital documents, issue and revoke attribute certificates.</t>
<t><spanx style="verb">identification</spanx>: They key is used only to identify the subject. Ex: login.</t>
<t><spanx style="verb">encryption</spanx>: The key is used only for any person to encrypt messages to the subject.</t>
<t><spanx style="verb">certification</spanx>: The key is used only to issue digital certificates.</t>
<t><spanx style="verb">revocation</spanx>: They key is used only to issue certificate revocations.</t>
</list></t>
</list>
</t>
<t>Each key MUST NOT be used in any algorithms other than the one prescribed on the key <spanx style="verb">usage</spanx>.</t>
<t>Key material MUST NOT be reused.</t>
</section>

<section anchor="subject-attributes" title="Subject Attributes">
<t>Attributes in the singular are a single value and attributes in the plural are arrays.</t>
<t>The CA MUST verify the attributes it will use on certificates it issues. If any verification is not done or fails, the corresponding attributes MUST NOT be included in the issued certificate. Examples:</t>
<t>
<list style="numbers">
<t>If the CA fails to verify that a phone number really belongs to the subject, it MUST never be included.</t>
<t>If the subject of the certificate to be issued forgets to bring their US/SSN, this attribute MUST NOT be included in the certificate.</t>
</list>
</t>
<t>A CA MAY refuse to issue a certificate if essential properties could not verified. Examples: INT/name, US/SSN, BR/RG, BR/CPF.</t>

<section anchor="int-type" title="INT/type">
<t>An enum describing the type of the subject. Possible values are: <spanx style="verb">natural person</spanx>, <spanx style="verb">legal person</spanx>, and <spanx style="verb">other</spanx> (ex: software).</t>
</section>

<section anchor="int-names" title="INT/names">
<t>Each name is a one line Unicode string.</t>
<t>All name entries each MUST be at most 5 KiB long.</t>
<t>All apps MUST support such long names. They MAY, however, show only the beginning of the name by default and have a simple way to show the full name. Example: a tooltip or a button close to the name.</t>
<t>There MUST be at least one name in the <spanx style="verb">INT/name</spanx> attribute.</t>
<t>Any prefixes, suffixes, infixes, honorifics and similar things attached to the name MUST be verified. Example: a person may never use the prefix &quot;Dr.&quot; if they have no valid doctorates degree.</t>
<t>Generic prefixes like &quot;Mr.&quot; or &quot;Ms.&quot; and job titles MUST NOT be included in any of the names.</t>
<t>For legal persons, it is RECOMMENDED to follow the convention: <spanx style="verb">(&lt;Acronym&gt;) &lt;Full Legal Name&gt; &lt;Any special endings&gt;</spanx> Examples:</t>
<t>
<list style="numbers">
<t>(USP) Universidade São Paulo</t>
<t>Monsters Inc.</t>
<t>Empresa Qualquer Serviços e Comércio LTDA</t>
</list>
</t>
<t>For natural persons, it is RECOMMENDED to follow the convention: <spanx style="verb">(&lt;Nick Name&gt;) &lt;First Name&gt; &lt;Full Middle Name&gt; &lt;Last Name&gt;</spanx> Examples:</t>
<t>
<list style="numbers">
<t>Dennis MacAlister Ritchie</t>
<t>(FHC) Fernando Henrique Cardoso</t>
<t>(Dom Pedro II) Pedro de Alcântara João Carlos Leopoldo Salvador Bibiano Francisco Xavier de Paula Leocádio Miguel Gabriel Rafael Gonzaga</t>
</list>
</t>
</section>

<section anchor="int-parents" title="INT/parents">
<t>An array of entities. The order MUST NOT be assigned any meaning. The array MAY have any number of elements.</t>
<t>The <spanx style="verb">INT/parents</spanx> attribute MAY lead to a recursive behaviour. This attribute SHOULD NOT exceed the grandparents generations.</t>
<t>Example:</t>

<figure><artwork type="js">[
  {&quot;id&quot;: &quot;BR/CPF&quot;, &quot;INT/names&quot;: [&quot;João da Silva&quot;], &quot;BR/CPF&quot;: &quot;123.456.789-00&quot;},
  {&quot;id&quot;: &quot;BR/CPF&quot;, &quot;INT/names&quot;: [&quot;Maria da Silva&quot;], &quot;BR/CPF&quot;: &quot;987.654.321-00&quot;},
  {&quot;id&quot;: &quot;BR/CPF&quot;, &quot;INT/names&quot;: [&quot;Joaquim Freitas&quot;], &quot;BR/CPF&quot;: &quot;987.654.321-00&quot;}
]
</artwork></figure>
</section>

<section anchor="int-guardians" title="INT/guardians">
<t>Pretty much the same as the <spanx style="verb">INT/parents</spanx> attribute.</t>
<t>It it is present, the entities <spanx style="verb">INT/parents</spanx> MUST NOT be considered as legal guardians.</t>
<t>It is absent, the entities <spanx style="verb">INT/parents</spanx> MAY be assumed to be legal guardians.</t>
<t>Example:</t>

<figure><artwork type="js">[
  {&quot;id&quot;: &quot;BR/CPF&quot;, &quot;INT/names&quot;: [&quot;João da Silva&quot;], &quot;BR/CPF&quot;: &quot;123.456.789-00&quot;},
  {&quot;id&quot;: &quot;BR/CPF&quot;, &quot;INT/names&quot;: [&quot;Maria da Silva&quot;], &quot;BR/CPF&quot;: &quot;987.654.321-00&quot;},
  {&quot;id&quot;: &quot;BR/CPF&quot;, &quot;INT/names&quot;: [&quot;Joaquim Freitas&quot;], &quot;BR/CPF&quot;: &quot;987.654.321-00&quot;}
]
</artwork></figure>
</section>

<section anchor="int-emails" title="INT/emails">
<t>An array of the subject's email addresses.</t>
<t>The fist entry is considered the main one.</t>
<t>The subject MAY have no email address.</t>
<t>It is RECOMMENDED to have at least one ASCII email address.</t>
<t>Examples:</t>

<figure><artwork type="js">// Okay:
[]
[&quot;someone@example.com&quot;]
[&quot;josé@construções-ltda.br&quot;, &quot;jose@construcoes-ltda.br&quot;]
[&quot;josé@construções-ltda.br&quot;, &quot;jose@xn--construes-ltda-mjb8t.br&quot;]
[&quot;josé@construções-ltda.br&quot;, &quot;jose@construcoes-ltda.br&quot;,
 &quot;josé@xn--construes-ltda-mjb8t.br&quot;]
[&quot;josé@construções-ltda.br&quot;]
[&quot;jose@construcoes-ltda.br&quot;, &quot;josé@construções-ltda.br&quot;]
</artwork></figure>
</section>

<section anchor="int-phones" title="INT/phones">
<t>For SPAM/robo-calling prevention the subject MUST have the right to refuse the inclusion of the <spanx style="verb">INT/phone</spanx> attribute.</t>
<t>The phone numbers MUST be encoded as a string array. Each element of that array represents one phone number and MUST include the country and area codes.</t>
<t>The country code part MUST begin with a <spanx style="verb">+</spanx> (plus sign) and have a space to separate it from the rest of the number. This is mainly to aid humans, by separating the international part from the local one.</t>
<t>The rest of the number SHOULD follow the traditions and conventions of the country in question and MAY include punctuation.</t>
<t>Examples:</t>

<figure><artwork type="js">// Okay:
[]
[&quot;+55 (11) 0 0000-0000&quot;, &quot;+55 0800 000&quot;]
// Wrong:
[&quot;+55(11) 0 0000-0000&quot;, &quot;+550800000&quot;, &quot;55 0800 000&quot;]
</artwork></figure>
<t>Note: This attribute is intended to be used by some legal persons and by pretty much no natural persons.</t>
</section>

<section anchor="int-addresses" title="INT/addresses">
<t>For security reasons the subject MUST have the right to refuse the inclusion of <spanx style="verb">INT/address</spanx> attribute.</t>
</section>

<section anchor="int-pictures" title="INT/pictures">
<t>For privacy reasons the subject SHOULD have the right to refuse the inclusion of <spanx style="verb">INT/pictures</spanx> attribute. The CA, however, CAN require this attribute but its is encouraged not to require it.</t>
<t>The picture MUST always be static: no animated GIFs or similar.</t>
<t>For natural persons the image MUST be picture of the subject. The specific are left to the CA, but it SHOULD follow the traditions and conventions of the CA's country.</t>
<t>One suggestion for CAs is to follow the ICAO guidlines on photos for passports (see <xref target="ICAO-9303"></xref>).</t>
<t>For legal persons the image MUST be a logo or other symbol that represents the subject. It MUST NOT be a picture of the owners or of the place where the subject is. Again, specific are left to the CA.</t>
<t>Support for this property in apps is OPTIONAL but RECOMMENDED to those that have a GUI.</t>
<t>Those that decide to implement this property MUST be able do decode both JPEG and PNG.</t>
<t>The picture MUST be data URL encoded using base64 and MUST NOT exceed 1 MiB. The size restriction applies to the image itself, not to the string that encodes it.</t>
<t>The picture MUST NOT be rotated using metadata (see <xref target="JPEG-HOFF"></xref>) regardless of the file type (JPGE or PNG or other).</t>
<t>Example: (Tux, the Linux mascot)</t>

<figure><artwork>[&quot;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD//gAiUmVzaXplZCB3aXRoIGV6Z2lmLmNvbSBHSUYgbWFrZXL/2wBDAAUDBAQEAwUEBAQFBQUGBwwIBwcHBw8LCwkMEQ8SEhEPERETFhwXExQaFRERGCEYGh0dHx8fExciJCIeJBweHx7/2wBDAQUFBQcGBw4ICA4eFBEUHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh7/wAARCAAmACADASIAAhEBAxEB/8QAGQAAAwEBAQAAAAAAAAAAAAAABgcIAAUE/8QALRAAAQMDAgQFAwUAAAAAAAAAAQIDBAUGEQAHEiExQQgTFCJxFVGBMlJhcrH/xAAXAQEBAQEAAAAAAAAAAAAAAAADAgQF/8QAJhEAAgICAQMCBwAAAAAAAAAAAQIDBAARMQUhQRNxEhQigaHR8P/aAAwDAQACEQMRAD8AsvUleN/cDcWk1yNb1lyajTqbGhtyajLhZStS3XFIbQVjmB7eg6lXPtqtdIDcOnRbm3bqkyNR/rkWkw40GTggoRJKnFlscsFQSWyRk4ynvrNbnavC0ioXI8Dk4kSB3Ck698C/CbuduEncRG2u4Sp77kmnqlRXZ6wt9C0ZJHEOZSUhXI5IKfkarPUYXbHVs34gLGvKsQU06hSWnI3C0StDJdW55xUScgguhZ65GemNWWy4260h1paVtrSFJUk5CgehB+2kgkMsauVKk+DyPfWS6/CxG94Gb4Xi1Ym19auFTwbktx1NQh3XJWOFsAdzxHPwDrw7AWc7ZO2NLpk6U/JqcsmdUHXFlSlyHfevJ6nGQM98Z0P7xRYF8Nrt2tQEKhwZfmtKS4oLDqUlKVgggAjiJAORrsbN3nWLglVS3bho70eo0QoHr22iIs5pYPAtB6JXge5HY9P45dPrtO7akqxH6k58cHR17HnNM1KWGNZGHY5w/F5Y0C7dnKxMkrd9RRmVVGN7iQC2CVDGeWUcQ+caFvANe0y4ttqhbdRkuSXrfkpbjuOElXpnEkoSf6lKwPsMDtpj7+TfUWbLtGLLYaqFdhyGG0KUCrgKCFK4evCOIZP40u/B9ZI22g1KJWJTDlSqzjZU42CEAI4glHPv7lHOBn8aSbrVOCyKsr6c60D53v8AWSlSV4/VUbGNavWIuXKel02ruR3nlqcLb7QdQVHmeYwQPydB7G1941SpuTX7/n2021llLVCXzewf1OFxOOXYBJIz11tbRJ0ajBdWzHGA533G/P4xDbmeEozbHbOKrYOZQLoXetPvWq1+rqbLL/157jy2f2rQnII5YGMdemmzaFqtU2O1KqCm5dQ5KKwD5bZ+yAf9PP41tbSN02rLe+ZdAXAGif7X35yRYlWD0w2hvP/Z&quot;]
</artwork></figure>
</section>

<section anchor="int-passports" title="INT/passports">
<t>Each passport is encoded as a dictionary with the following keys:</t>
<t>
<list style="numbers">
<t><spanx style="verb">type</spanx>: Indicates the type of document, for passports this is a <spanx style="verb">P</spanx>.</t>
<t><spanx style="verb">number</spanx>: A string, which MAY contain letters, the identifies this passport.</t>
<t><spanx style="verb">country</spanx>: The country that issued the passport.</t>
<t><spanx style="verb">surname</spanx>: The subject's last name.</t>
<t><spanx style="verb">given_name</spanx>: The subject's first name.</t>
<t><spanx style="verb">nationality</spanx>: The subject's nationality.</t>
<t><spanx style="verb">date_of_birth</spanx>: The subject's date of birth.</t>
<t><spanx style="verb">place_of_birth</spanx>: The subject's place of birth.</t>
<t><spanx style="verb">personal_number</spanx>: An id number identifying the subject.</t>
<t><spanx style="verb">sex</spanx>: The sex or gender of the subject. Note that <spanx style="verb">X</spanx> and other characters may be used instead of the traditional <spanx style="verb">F</spanx> and <spanx style="verb">M</spanx>.</t>
<t><spanx style="verb">date_of_issue</spanx>: The date in which the passport was issued.</t>
<t><spanx style="verb">date_of_expiry</spanx>: The date in which the passport will expire.</t>
<t><spanx style="verb">MRZ</spanx>: the contents on the MRZ (machine readable zone).</t>
</list>
</t>
<t>Only <spanx style="verb">type</spanx>, <spanx style="verb">country</spanx> and <spanx style="verb">number</spanx> MUST be present.</t>
<t>The <spanx style="verb">given_name</spanx> and <spanx style="verb">surname</spanx> are OPTIONAL because some people may have no first or last name. However, at least one of them MUST be included.</t>
<t>Except of dates, it is RECOMMENDED that all fields match the way they are presented on the VIZ (Visual Inspection Zone), rather than the MRZ.</t>

<figure><artwork type="js">{
    &quot;type&quot;: &quot;P&quot;,
    &quot;country&quot;: &quot;UTO&quot;, // This **MAY NOT** match ISO 3166-1, read ICAO Doc 9303 (pages 22 to 29) for details.
    &quot;number&quot;: &quot;L898902C3&quot;,
    &quot;surname&quot;: &quot;ERIKSSON&quot;,
    &quot;given_name&quot;: &quot;ANNA MARIA&quot;,
    &quot;nationality&quot;: &quot;UTOPIAN&quot;,
    &quot;date_of_birth&quot;: &quot;1974-08-12&quot;,
    &quot;place_of_birth&quot;: &quot;ZENITH&quot;,
    &quot;personal_number&quot;: &quot;Z E 184226 B&quot;,
    &quot;sex&quot;: &quot;F&quot;, /* Do NOT assume it is &quot;F&quot; or &quot;M&quot;, other characters,
                   such as &quot;X&quot; may de used. */
    &quot;date_of_issue&quot;: &quot;2007-04-16&quot;,
    &quot;date_of_expiry&quot;: &quot;2012-04-15&quot;,
    &quot;MRZ&quot;: &quot;P&lt;UTOERIKSSON&lt;&lt;ANNA&lt;MARIA&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\nL898902C36UTO7408122F1204159ZE184226B&lt;&lt;&lt;&lt;&lt;10&quot;
}
</artwork></figure>
</section>
</section>
</section>

<section anchor="certification-chain" title="Certification Chain">
<t>👉 Open Question: Should software receive certificates? Ex: Should a bank have a specific certificate only for its web server that is used not for SSL but for singing that it approved clients requests (loans for instance) and singing bank statements?</t>

<section anchor="public-key-infrastructure" title="Public Key Infrastructure">
</section>

<section anchor="nameless-certificates" title="Nameless Certificates">
<t>👉 Open Question: It is feature a good idea?</t>
<t>Nameless certificates are self signed certificates meant for the end user. They are intended to serve as a way for people to start using and testing JUDSYS-1 without the need to pay the CAs.</t>
<t>All nameless certificates MUST have, on both <spanx style="verb">subject</spanx> and <spanx style="verb">issuer</spanx>, the <spanx style="verb">INT/name</spanx> attribute with a single element <spanx style="verb">Nameless Certificate</spanx>. There MUST NOT be any other names.</t>
<t>The choice to prohibit names is intentional, as it ensures that no app will be able to display an unverified name, thus forcing the user to keep an &quot;address book&quot; to associate each person to their certificate.</t>
</section>

<section anchor="revocation" title="Revocation">
</section>
</section>

<section anchor="proof-of-attribute" title="Proof of attribute">

<section anchor="standard-attributes" title="Standard attributes">

<section anchor="int-job" title="INT/job">
<t>This MUST NOT be an array.</t>
<t>A simple trimmed one line string containing the subject's job title.</t>
<t>The job title MUST NOT include the name of the organization.</t>
<t>All apps MUST show the issuer's name and the job title of the attributes certificate together.</t>
<t>Valid examples:</t>
<t>
<list style="numbers">
<t>Consul</t>
<t>Questor</t>
<t>President</t>
<t>CEO</t>
<t>CEO, Cheif Executive Officer</t>
<t>Ministro</t>
<t>Ministro da 1ª turma</t>
</list>
</t>
<t>Wrong examples (organization MUST NOT be in the job title):</t>
<t>
<list style="numbers">
<t>President of the US</t>
<t>Presidente da República</t>
<t>Justice of the Supreme Court</t>
<t>Presidente do Senado</t>
<t>Ministro da 1ª turma do Supremo Tribunal Federal</t>
</list>
</t>
</section>
</section>
</section>

<section anchor="signatures" title="Signatures">

<section anchor="standard-attributes-1" title="Standard attributes">
<t>All signature attributes MUST NOT be arrays.</t>
<t>The <spanx style="verb">INT/date</spanx> and <spanx style="verb">INT/reason</spanx> attributes are MANDATORY. All others are OPTIONAL, but each country MAY require certain attributes.</t>

<section anchor="int-reason" title="INT/reason">
<t>A dictionary that indicates why the signer is signing this document. Possible keys:</t>
<t>
<list style="numbers">
<t><spanx style="verb">sent</spanx>: The signer sent the document.</t>
<t><spanx style="verb">created</spanx>: The signer created the document.</t>
<t><spanx style="verb">approved</spanx>: The signer approved or accepted the document (this is the most common type signature).</t>
<t><spanx style="verb">rejected</spanx>: The signer rejected the document.</t>
<t><spanx style="verb">delivered</spanx>: The signer placed the document where the recipient is expected to look regularly. Example: A server placed an email on the recipient's account.</t>
<t><spanx style="verb">received</spanx>: The signer received the document. Example: a person counter-signs with this key to confirm they received an email.</t>
<t><spanx style="verb">timestamp</spanx>: The signer testifies that the document existed at that moment in time.</t>
<t><spanx style="verb">witness</spanx>: The signer testifies they saw the previous signings occur at the said time and without coercion.</t>
<t><spanx style="verb">matches-original</spanx>: The signer testifies that the file being signed is an authentic copy/scan of the original physical document.</t>
</list>
</t>
<t>All undefined values MUST be interpreted as false.</t>
<t>Apps MUST NOT add their own keys.</t>
<t>Both the <spanx style="verb">approved</spanx> and <spanx style="verb">rejected</spanx> keys MAY be true at the same time. When this happens, it means that the signer approved a part of the document and rejected another. The user MUST be informed when this happens.</t>
</section>

<section anchor="int-location" title="INT/location">
<t>A dictionary with the following keys:</t>
<t>
<list style="numbers">
<t><spanx style="verb">country</spanx>: A string with the country code.</t>
<t><spanx style="verb">zip</spanx>: A string with the place's ZIP code equivalent according to the the country.</t>
<t><spanx style="verb">lat</spanx>: A float in the interval [-90, +90] representing the latitude of the place.</t>
<t><spanx style="verb">lon</spanx>: A float in the interval [-180, +180] representing the longitude of the place.</t>
<t><spanx style="verb">state</spanx>: A string indicating the state or province of the place, preferably as a code. Examples: &quot;DC&quot; of District of Columbia, USA. &quot;AP&quot; for Amapá, Brazil.</t>
<t><spanx style="verb">city</spanx>: The city or municipality of the place.</t>
<t><spanx style="verb">street</spanx>: The street name.</t>
<t><spanx style="verb">number</spanx>: A string (never a number) with the street number or name of the building.</t>
<t><spanx style="verb">complement</spanx>: A string with the complement for the address.</t>
<t><spanx style="verb">text</spanx>: A multi line string describing the place according to the rule sin the country. This is mainly intended for countries with different postal conventions.</t>
</list>
</t>
<t>The <spanx style="verb">country</spanx> key MUST be present. All others are MAY be empty.</t>
<t><spanx style="verb">lat</spanx> and <spanx style="verb">lon</spanx> are mainly intended to automatically show markers on maps for the end user.</t>
</section>

<section anchor="int-date" title="INT/date">
<t>A string with the time in which the signer claims to have signed the document.</t>
<t>All apps MUST warn the user that this value is just a claim which may be false.</t>
</section>

<section anchor="int-file" title="INT/file">
<t>An object containing information about the file being signed.</t>

<figure><artwork type="js">{
    &quot;filename&quot;: &quot;contract.txt&quot;,
    &quot;size&quot;: 9007199254740991, // in bytes, 8 PiB in this case
    &quot;hash&quot;: &quot;SHA-3-512=A69F73CCA23A9AC5C8B567DC185A756E97C982164FE25859E0D1DCC1475C80A615B2123AF1F5F94C11E3E9402C3AC558F500199D95B6D3E301758586281DCD26&quot;
}
</artwork></figure>
<t>A signature verification MUST NOT fail because the file was renamed.</t>
</section>

<section anchor="int-counter" title="INT/counter">
<t>An array of base64 string encoding the previous signatures.</t>
<t>A signature verification MUST NOT fail because the file was renamed.</t>
</section>
</section>

<section anchor="signature-request" title="Signature Request">
</section>
</section>

<section anchor="internet-apis" title="Internet APIs">

<section anchor="online-restful" title="Online RESTful">

<section anchor="sign-certificate" title="Sign certificate">
</section>

<section anchor="certificate-revocation-status" title="Certificate revocation status">
</section>

<section anchor="time-stamps-authorities" title="Time-stamps Authorities">
</section>
</section>

<section anchor="browser-interaction" title="Browser interaction">
</section>
</section>

<section anchor="smart-cards" title="Smart-cards">
</section>

<section anchor="security-and-usability-considerations" title="Security and Usability Considerations">
<t>✏️</t>

<section anchor="mixing-digital-and-paper-signatures" title="Mixing digital and paper signatures">
</section>

<section anchor="dynamic-content" title="Dynamic Content">
<t>All signing apps MUST warn the user when the document they are trying to sign seems to have dynamic content.</t>
<t>All signing apps MUST also not show the warning to the user if they have checked and failed to find signs of dynamic content on the file being signed.</t>
<t>If a signing app cannot verify the file for dynamic content and it is not on the white list, it MUST warn the user about the possibility of dynamic content.</t>
<t>For PDF, the verification MUST check for, and fail to find all of the following:</t>
<t>
<list style="numbers">
<t>Any signs of JavaScript.</t>
</list>
</t>
<t>For HTML, the verification MUST check for, and fail to find all of the following:</t>
<t>
<list style="numbers">
<t>The <spanx style="verb">&lt;script&gt;</spanx> tag.</t>
<t>Properties such as <spanx style="verb">onclick</spanx> and <spanx style="verb">oninput</spanx> on any tags.</t>
<t>External URLs for the tags <spanx style="verb">&lt;link&gt;</spanx> and <spanx style="verb">&lt;style&gt;</spanx>. Note that links, <spanx style="verb">&lt;a&gt;</spanx> tag, are fine regardless of the URL they point to and the <spanx style="verb">&lt;script&gt;</spanx> tag will fail the verification independently of the URL.</t>
</list>
</t>
<t>For Office Open XML (MOX), Open Document Format for Office Applications (ODF) and older Microsoft Office files, the verification MUST check for, and fail to find all of the following:</t>
<t>
<list style="numbers">
<t>OLE content.</t>
<t>(✏️ what else?)</t>
</list>
</t>
<t>All signing apps CAN assume that the following file formats have no dynamic content:</t>
<t>
<list style="numbers">
<t>Image files, including JPEG (<spanx style="verb">.jpg</spanx> and <spanx style="verb">.jpeg</spanx>), PNG (<spanx style="verb">.png</spanx>), GIF (<spanx style="verb">.gif</spanx>), BMP (<spanx style="verb">.bmp</spanx>) and TIFF (<spanx style="verb">.tiff</spanx> and <spanx style="verb">.tif</spanx>).</t>
<t>Text files, including pure text (<spanx style="verb">.txt</spanx>) and rich text (<spanx style="verb">.rtf</spanx>).</t>
<t>Markdown files (<spanx style="verb">.md</spanx>).</t>
<t>TeX files (<spanx style="verb">.tex</spanx>).</t>
<t>XML files (<spanx style="verb">.xml</spanx>).</t>
</list>
</t>
<t>All signing apps MUST check extension in a case insensitive manner.</t>
</section>

<section anchor="accidental-changes" title="Accidental changes">
<t>👉 Decide how to handle the case of a user who opened a word file, accidentally added a new line and saved it. The best option seems to be mandatory PAR2 support.</t>
</section>

<section anchor="archive-files" title="Archive files">
<t>👉 Decide how to handle the case of a user trying to sign a <spanx style="verb">.zip</spanx> or <spanx style="verb">.rar</spanx> file. Should they be warned about the fact the signature will only apply to all those files together instead of separately?</t>
</section>

<section anchor="user-misinterpretation-and-excessive-trust-on-the-machine" title="User misinterpretation and excessive trust on the machine">
</section>

<section anchor="certificate-and-password-sharing" title="Certificate and password sharing">
</section>

<section anchor="cloud-usage" title="Cloud usage">
</section>

<section anchor="side-channel-attacks" title="Side channel attacks">
</section>

<section anchor="document-replacement" title="Document replacement">
</section>
</section>

<section anchor="language-specific-rules" title="Language Specific Rules">

<section anchor="portuguese" title="Portuguese">

<section anchor="unicode-support" title="Unicode Support">
<t>All apps aimed to support Portuguese MUST support the following Unicode blocks:</t>
<t>
<list style="numbers">
<t>Basic Latin (U+0000..U+007F).</t>
<t>Latin-1 Supplement (U+00A0..U+00FF). This range excludes the need for supporting C1 Controls.</t>
</list>
</t>
</section>

<section anchor="standard-translations" title="Standard Translations">
<texttable>
<ttcol>English</ttcol>
<ttcol>Portuguese</ttcol>


<c>(PA) Proof of certificate</c>
<c>(CA) Comprovante de Atributo</c>

<c>Certificate</c>
<c>Certificado</c>

<c>(CA) Certificate Authority</c>
<c>(AC) Autoridade Certificadora</c>

<c>(PKI) Public Key Infrastructure</c>
<c>(ICP) Infraestrutura de Chaves Públicas</c>

<c>(TA) Timestamping Authority</c>
<c>(ACT) Autoridade de Carimbo de Tempo</c>

<c>Subject</c>
<c>Titular</c>

<c>Issuer</c>
<c>Emissor</c>

</texttable></section>
</section>
</section>

<section anchor="country-specific-rules" title="Country Specific Rules">

<section anchor="brazil" title="Brazil">
<t>All certificates issued for natural persons MUST have the following attributes:</t>
<t>
<list style="numbers">
<t><spanx style="verb">BR/CPF</spanx></t>
<t><spanx style="verb">BR/RG</spanx> or <spanx style="verb">BR/RNE</spanx> or <spanx style="verb">INT/passport</spanx>: The certificate MAY have any combination of them so long as there is at least one.</t>
</list>
</t>
<t>For legal persons, the <spanx style="verb">INT/name</spanx> attribute MUST be the full &quot;razão social&quot;.</t>
<t>Even if official documents show a name in all caps, all names MUST have propper capitalization. Ex: &quot;Pedro de Alântara&quot;, not &quot;PEDRO DE ALCÂNTARA&quot; nor &quot;Pedro De Alcântara&quot;.</t>
<t>All certificates issued for legal persons MUST have the following attributes:</t>
<t>
<list style="numbers">
<t><spanx style="verb">BR/CNPJ</spanx></t>
</list>
</t>
<t>For legal persons, they SHOULD also have, when possible:</t>
<t>
<list style="numbers">
<t><spanx style="verb">BR/IE</spanx> (inscrição estadual)</t>
<t><spanx style="verb">BR/IM</spanx> (inscrição municipal)</t>
<t><spanx style="verb">BR/NIRE</spanx> (junta comercial)</t>
</list>
</t>
</section>

<section anchor="subject-attributes-1" title="Subject Attributes">

<section anchor="br-cpf" title="BR/CPF">
<t>CPF (<spanx style="emph">Cadastro de Pessoas Físicas</spanx>) number. This MUST be encoded as a trimmed string with the format: <spanx style="verb">999.999.999/99</spanx>.</t>
<t><spanx style="verb">BR/CPF</spanx> MUST NOT be encoded as an array.</t>
<t>Example: <spanx style="verb">001.456.789/00</spanx></t>
<t>All apps MUST NOT reject a BR/CPF entry because the verification digits (the last two) are incorrect.</t>
</section>

<section anchor="br-cnpj" title="BR/CNPJ">
<t>CNPJ (<spanx style="emph">Cadastro Nacional de Pessoas Jurídicas</spanx>) number. This MUST be encoded as a trimmed string with the format: <spanx style="verb">99.999.999/9999-99</spanx>.</t>
<t><spanx style="verb">BR/CNPJ</spanx> MUST NOT be encoded as an array.</t>
<t>Example: <spanx style="verb">01.012.123/0001-99</spanx></t>
<t>All apps MUST NOT reject a <spanx style="verb">BR/CNPJ</spanx> entry because the verification digits (the last two) are incorrect.</t>
</section>

<section anchor="br-rne" title="BR/RNE">
<t>RNE (<spanx style="emph">Registro Nacional de Estrangeiros</spanx>) MUST be encoded as a string with all punctuation.</t>
<t>Example: ✏️</t>
</section>

<section anchor="br-rg" title="BR/RG">
<t>RG (<spanx style="emph">Registro Geral</spanx>) MUST be encoded as an array of dictionaries with the keys:</t>
<t>
<list style="numbers">
<t><spanx style="verb">number</spanx> for the RG number which MUST include punctuation.</t>
<t><spanx style="verb">digit</spanx> for the verification digit, i.e. the character after the hyphen. If the subject RG has no digit this string MUST be empty.</t>
<t><spanx style="verb">state</spanx> the two letter uppercase code for the federative unit that issued the document.</t>
<t><spanx style="verb">issuer</spanx> the institution that actually issued the RG.</t>
<t><spanx style="verb">short_form</spanx> a concise string expressing the main things about the RG. The following algorithm MUST be used:</t>
</list>
</t>

<figure><artwork type="pseudo">IF digit IS present THEN
    short_form = number + &quot;-&quot; + digit + &quot; /&quot; + state
ELSE
    short_form = number + &quot; /&quot; + state
END IF
</artwork></figure>
<t>Example of an RG:</t>

<figure><artwork type="js">{
    // Number with punctuation
    &quot;number&quot;: &quot;12.345.678&quot;,
    // The character after the hyphen when present
    &quot;digit&quot;: &quot;X&quot;,
    // The issuing state (two letter upper case code)
    &quot;state&quot;: &quot;DF&quot;,
    // Issuing organization (&quot;órgão emissor&quot;) with diacritics
    &quot;issuer&quot;: &quot;Secretaria de Segurança Pública&quot;,
    // number + &quot; &quot; + state (if digit == &quot;&quot;)
    // number + &quot;-&quot; + digit + &quot; &quot; + state (if digit == &quot;&quot;)
    &quot;short_form&quot;: &quot;12.345.678-X DF&quot;
}
</artwork></figure>
</section>

<section anchor="br-título-de-eleitor" title="BR/Título de Eleitor">
</section>

<section anchor="br-nit" title="BR/NIT">
</section>
</section>
</section>

<section anchor="json-schemas" title="JSON Schemas">

<section anchor="certificate-file-j1c" title="Certificate File (.j1c)">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/j1c.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 .j1c file&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;what&quot;, &quot;certificates&quot;],
  &quot;additionalProperties&quot;: true,
  &quot;properties&quot;: {
    &quot;what&quot;: {
      &quot;const&quot;: &quot;JUDSYS-1 Certificate File (.j1c)&quot;
    },
    &quot;certificates&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;$ref&quot;: &quot;https://judsys.github.io/schema/signed-object.json&quot;
      }
    }
  }
}
</artwork></figure>
</section>

<section anchor="private-keys-file-j1k" title="Private Keys File (.j1k)">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/j1c.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 .j1c file&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;what&quot;, &quot;certificates&quot;],
  &quot;additionalProperties&quot;: false,
  &quot;properties&quot;: {
    &quot;what&quot;: {
      &quot;const&quot;: &quot;JUDSYS-1 Private Keys File (.j1k)&quot;
    },
    &quot;certificates&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;$ref&quot;: &quot;https://judsys.github.io/schema/signed-object.json&quot;
      }
    },
    &quot;private-keys&quot;: {
      &quot;description&quot;: &quot;An encrypted message containing an array of private keys for the first certificate present on the certificates array.&quot;,
      &quot;$ref&quot;: &quot;https://judsys.github.io/schema/encrypted-object.json&quot;
    }
  }
}
</artwork></figure>
</section>

<section anchor="proof-of-attribute-file-j1a" title="Proof of Attribute File (.j1a)">
</section>

<section anchor="detached-digital-signature-file-j1s" title="Detached Digital Signature File (.j1s)">
</section>

<section anchor="encrypted-file-j1e" title="Encrypted File (.j1e)">
</section>

<section anchor="revocation-information-file-j1r" title="Revocation Information File (.j1r)">
</section>

<section anchor="hash-optionally-salted" title="Hash (optionally salted)">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/hash.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 salted hash&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;algorithm&quot;, &quot;value&quot;],
  &quot;additionalProperties&quot;: true,
  &quot;properties&quot;: {
    &quot;algorithm&quot;: {
      &quot;enum&quot;: [&quot;SHA-3-512&quot;],
      &quot;description&quot;: &quot;The hashing algorithm&quot;
    },
    &quot;value&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The hash of the salted password, hex encoded&quot;
    },
    &quot;salt&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The password salt, hex encoded&quot;
    }
  }
}
</artwork></figure>
</section>

<section anchor="aes-256-cbc" title="AES-256-CBC">
<t>Advanced Encryption Standard with 256 bit keys in CBC (Cipher Block Chaining) mode.</t>

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/aes-256-cbc.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Algorithm Identifier for AES-256-CBC&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;name&quot;, &quot;IV&quot;],
  &quot;additionalProperties&quot;: false,
  &quot;properties&quot;: {
    &quot;name&quot;: {
      &quot;const&quot;: &quot;AES-256-CBC&quot;
    },
    &quot;IV&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;A hex encoding of the initialization vector&quot;
    }
  }
}
</artwork></figure>
</section>

<section anchor="argon2" title="Argon2">
</section>

<section anchor="ecdsa" title="ECDSA">
</section>

<section anchor="encrypted-object" title="Encrypted Object">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/encrypted-object.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Signed Object&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;what&quot;, &quot;raw&quot;, &quot;alg&quot;, &quot;key_src&quot;],
  &quot;additionalProperties&quot;: false,
  &quot;properties&quot;: {
    &quot;what&quot;: {
      &quot;const&quot;: &quot;JUDSYS-1 Encrypted Object&quot;
    },
    &quot;raw&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;A base64 encoding of the encrypted JSON object.&quot;
    },
    &quot;algorithm&quot;: {
      &quot;description&quot;: &quot;The encryption algorithm.&quot;,
      &quot;oneOf&quot;: [
        { &quot;$ref&quot;: &quot;https://judsys.github.io/schema/aes-256-cbc.json&quot; }
      ]
    },
    &quot;key_src&quot;: {
      &quot;enum&quot;: [&quot;password&quot;, &quot;key-file&quot;]
    },
    &quot;key_id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The ID of the public key&quot;
    },
    &quot;key_password&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;derivation&quot;: {
          &quot;description&quot;: &quot;The key derivation algorithm.&quot;,
          &quot;oneOf&quot;: [
            { &quot;$ref&quot;: &quot;https://judsys.github.io/schema/argon2id.json&quot; }
          ]
        },
        &quot;hash&quot;: {
          &quot;$ref&quot;: &quot;https://judsys.github.io/schema/hash.json&quot;
        }
      }
    }
  }
}
</artwork></figure>
</section>

<section anchor="signed-object" title="Signed Object">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/signed-object.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Signed Object&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;what&quot;, &quot;raw&quot;, &quot;sig&quot;],
  &quot;additionalProperties&quot;: true,
  &quot;properties&quot;: {
    &quot;what&quot;: {
      &quot;const&quot;: &quot;JUDSYS-1 Signed Object&quot;
    },
    &quot;raw&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;A base64 encoding of the JSON object.&quot;
    },
    &quot;sig&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;A base64 encoding of the signature.&quot;
    }
  }
}
</artwork></figure>
</section>

<section anchor="key" title="Key">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/key.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 key&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;algorithm&quot;, &quot;kind&quot;, &quot;id&quot;, &quot;usage&quot;],
  &quot;additionalProperties&quot;: true,
  &quot;properties&quot;: {
    &quot;algorithm&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;kind&quot;: {
      &quot;enum&quot;: [&quot;public&quot;, &quot;private&quot;]  
    },
    &quot;id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;A value that uniquely identifies that key (algorithm dependent)&quot;  
    },
    &quot;usage&quot;: {
      &quot;enum&quot;: [&quot;identification&quot;, &quot;signing&quot;, &quot;encryption&quot;, &quot;issue-certs&quot;, &quot;revoke-certs&quot;]
    }
  }
}
</artwork></figure>

<section anchor="rsa" title="RSA">
<t>All RSA private keys MUST have exactly two primes.</t>
<t>The key ID MUST be <spanx style="verb">&quot;RSA/&quot; + sha-3-512(N + &quot;|&quot; + E)</spanx> (all values are strings and all numbers are in base 10).</t>

<section anchor="rsa-public" title="RSA Public">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/key-rsa-public.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 key&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;algorithm&quot;, &quot;kind&quot;, &quot;id&quot;, &quot;N&quot;, &quot;E&quot;],
  &quot;additionalProperties&quot;: false,
  &quot;properties&quot;: {
    &quot;algorithm&quot;: {
      &quot;const&quot;: &quot;RSA&quot;
    },
    &quot;kind&quot;: {
      &quot;const&quot;: &quot;public&quot;
    },
    &quot;id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;pattern&quot;: &quot;^RSA:[0-9a-fA-F]{128}$&quot;
    },
    &quot;N&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA public modulus N, in base 10&quot;
    },
    &quot;E&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA public exponent E, in base 10&quot;
    }
  }
}
</artwork></figure>
</section>

<section anchor="rsa-private" title="RSA Private">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/key-rsa-private.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 key&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;algorithm&quot;, &quot;kind&quot;, &quot;id&quot;, &quot;N&quot;, &quot;E&quot;, &quot;D&quot;, &quot;P&quot;, &quot;Q&quot;, &quot;DQ&quot;, &quot;DP&quot;, &quot;QINV&quot;],
  &quot;additionalProperties&quot;: false,
  &quot;properties&quot;: {
    &quot;algorithm&quot;: {
      &quot;const&quot;: &quot;RSA&quot;
    },
    &quot;kind&quot;: {
      &quot;const&quot;: &quot;private&quot;
    },
    &quot;id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;pattern&quot;: &quot;^RSA:[0-9a-fA-F]{128}$&quot;
    },
    &quot;N&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA public modulus N, in base 10&quot;
    },
    &quot;E&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA public exponent E, in base 10&quot;
    },
    &quot;D&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA private exponent D, in base 10&quot;
    },
    &quot;P&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA secret prime P, in base 10&quot;
    },
    &quot;Q&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;RSA secret prime Q, in base 10&quot;
    },
    &quot;DP&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;D mod (P-1), in base 10&quot;
    },
    &quot;DQ&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;D mod (Q-1), in base 10&quot;
    },
    &quot;QINV&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;Q^-1 mod P, in base 10&quot;
    }
  }
}
</artwork></figure>
</section>
</section>

<section anchor="ecdsa-public-key" title="ECDSA Public Key">
</section>
</section>

<section anchor="entity-subject-of-issuer" title="Entity (subject of issuer)">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/entity.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Entity&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;INT/type&quot;, &quot;INT/names&quot;],
  &quot;additionalProperties&quot;: true,
  &quot;properties&quot;: {
    &quot;id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The name of the attribute that no other entity will share. Ex: US/SSN, BR/CPF, INT/passport:number&quot;
    },
    &quot;INT/type&quot;: {
      &quot;enum&quot;: [&quot;natural person&quot;, &quot;legal person&quot;, &quot;other&quot;]
    },
    &quot;INT/vulnerable&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;type&quot;: &quot;string&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true,
      &quot;description&quot;: &quot;A list of entries explaining the reasons why this entity is vulnerable. Ex: iliterate, child, mentally ill, et cetera&quot;
    },
    &quot;INT/names&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;type&quot;: &quot;string&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;INT/emails&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;type&quot;: &quot;string&quot;,
        &quot;format&quot;: &quot;idn-email&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;INT/phones&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;type&quot;: &quot;string&quot;,
        &quot;pattern&quot;: &quot;^[+][0-9]{1,} .*$&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;INT/addresses&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;$ref&quot;: &quot;https://judsys.github.io/schema/address.json&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;INT/pictures&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;contentEncoding&quot;: &quot;base64&quot;,
        &quot;contentMediaType&quot;: &quot;image&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;INT/passports&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;$ref&quot;: &quot;https://judsys.github.io/schema/passport.json&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;INT/parents&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;$ref&quot;: &quot;https://judsys.github.io/schema/entity.json&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    }
  }
}
</artwork></figure>
</section>

<section anchor="certificate" title="Certificate">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/certificate.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Certificate&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;subject&quot;, &quot;notBefore&quot;, &quot;notAfter&quot;, &quot;serial&quot;, &quot;keys&quot;],
  &quot;properties&quot;: {
    &quot;serial&quot;: { &quot;type&quot;: &quot;string&quot; },
    &quot;subject&quot;: {
      &quot;$ref&quot;: &quot;https://judsys.github.io/schema/entity.json&quot;
    },
    &quot;issuer&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The key ID of the issue-certs key of the issuer.&quot;
    },
    &quot;notBefore&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;format&quot;: &quot;date-time&quot;
    },
    &quot;notAfter&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;format&quot;: &quot;date-time&quot;
    },
    &quot;keys&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;$ref&quot;: &quot;https://judsys.github.io/schema/key.json&quot;
      },
      &quot;minItems&quot;: 1,
      &quot;uniqueItems&quot;: true
    },
    &quot;legal-recognition&quot;: {
      &quot;type&quot;: &quot;array&quot;,
      &quot;items&quot;: {
        &quot;enum&quot;: [&quot;timestamp&quot;, &quot;matches-original&quot;]
      }
    }
  }
}
</artwork></figure>
</section>

<section anchor="address" title="Address">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/int-address.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Address&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;country&quot;],
  &quot;additionalProperties&quot;: false,
  &quot;properties&quot;: {
    &quot;country&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;zip&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;comment&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;Text describing addresses that do not fit into the structured model AND/OR additional comments about how to get to the place AND/OR access codes&quot;
    },
    &quot;recipient&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;complement&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;numberOrBuildingName&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;street&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;neighbourhood&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;city&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;state&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;If the country does not have states or provinces, this value MUST be a single hyphen '-'&quot;
    },
    &quot;lat&quot;: {
      &quot;type&quot;: &quot;number&quot;,
      &quot;minimum&quot;: -90,
      &quot;maximum&quot;: 90,
      &quot;description&quot;: &quot;The latitude of the address, preferably of the building entrance&quot;
    },
    &quot;lon&quot;: {
      &quot;type&quot;: &quot;number&quot;,
      &quot;minimum&quot;: -180,
      &quot;maximum&quot;: 180,
      &quot;description&quot;: &quot;The longitude of the address, preferably of the building entrance&quot;
    }
  }
}
</artwork></figure>
</section>

<section anchor="passport" title="Passport">

<figure><artwork type="json">{
  &quot;$id&quot;: &quot;https://judsys.github.io/schema/int-passport.json&quot;,
  &quot;title&quot;: &quot;JUDSYS-1 Entity&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;required&quot;: [&quot;country&quot;, &quot;number&quot;],
  &quot;additionalProperties&quot;: true,
  &quot;properties&quot;: {
    &quot;type&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;Type of travel document, usually a 'P' indicating passport.&quot;
    },
    &quot;country&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The country that ISSUED the passport.&quot;
    },
    &quot;number&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;surname&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The surname as it appears on the VIZ (Visual Inspection Zone)&quot;
    },
    &quot;givenName&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The given name as it appears on the VIZ (Visual Inspection Zone)&quot;
    },
    &quot;nationality&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;date_of_birth&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;format&quot;: &quot;date&quot;
    },
    &quot;place_of_birth&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;personal_number&quot;: {
      &quot;type&quot;: &quot;string&quot;
    },
    &quot;sex&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The sex of the passport holder. It may be 'X'.&quot;
    },
    &quot;date_of_issue&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;format&quot;: &quot;date&quot;
    },
    &quot;date_of_expiry&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;format&quot;: &quot;date&quot;
    },
    &quot;MRZ&quot;: {
      &quot;type&quot;: &quot;string&quot;
    }
  }
}
</artwork></figure>
</section>
</section>

</middle>

<back>
<references title="Normative References">
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"?>
<?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3339.xml"?>
</references>
<references title="Informative References">
<reference anchor='ITI-FAQ-21' target='http://www.iti.gov.br/perguntas-frequentes/41-perguntas-frequentes/567-questoes-juridicas#r21'>
 <front>
 <title>Perguntas Frequentes - Questões Jurídicas - Questão 21</title>
  <author>
      <organization>ITI - Instituto Nacional de Tecnologia da Informação</organization>
  </author>
  <date day='5' month='02' year='2018'/>
 </front>
 </reference>
<reference anchor='ICAO-9303' target='https://www.icao.int/publications/Documents/9303_p3_cons_en.pdf'>
 <front>
 <title>Machine Readable Travel Documents, Seventh Edition</title>
  <author>
      <organization>International Civil Aviation Organization</organization>
  </author>
  <date year='2015'/>
 </front>
 </reference>
<reference anchor='JPEG-HOFF' target='https://magnushoff.com/jpeg-orientation.html'>
 <front>
 <title>JPEG Orientation: Working with the JPEG/EXIF orientation tag</title>
  <author fullname='Magnus Hovland Hoff' initials='M.' surname='Hoff'>
    <address>
      <email>maghoff@gmail.com</email>
      <uri>https://magnushoff.com/</uri>
  </address>
  </author>
  <date year='2015'/>
 </front>
 </reference>
</references>

</back>

</rfc>
